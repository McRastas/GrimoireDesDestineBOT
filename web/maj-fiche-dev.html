<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé≤ G√©n√©rateur de Mise √† Jour de Fiche D&D - DEV</title>
    <link rel="stylesheet" href="styles-unified.css">
</head>
<body>
    <!-- Badge de d√©veloppement -->
    <div class="dev-badge">
        üöß VERSION D√âVELOPPEMENT
    </div>

    <!-- Navigation -->
    <div class="nav-links">
        <a href="index.html" class="nav-link">üé≤ Calculateur PV</a>
        <a href="maj-fiche-dev.html" class="nav-link active">üìù G√©n√©rateur Fiche (DEV)</a>
    </div>

    <div class="container">
        <div class="header">
            <h1>üé≤ G√©n√©rateur de Mise √† Jour de Fiche</h1>
            <p>Cr√©ez facilement vos messages Discord de mise √† jour D&D 5e</p>
            <div style="margin-top: 10px; font-size: 0.9rem; opacity: 0.8;">
                üöß Version de d√©veloppement - Fonctionnalit√©s en cours de test
            </div>
        </div>

        <div class="main-content">
            <div class="form-grid">
                <!-- Colonne de gauche : Formulaire -->
                <div>
                    <!-- Informations du personnage -->
                    <div class="form-section">
                        <h3>üìã Informations du Personnage</h3>
                        
                        <div class="form-group">
                            <label for="nom-pj">Nom du PJ :</label>
                            <input type="text" id="nom-pj" placeholder="Nom de votre personnage" required>
                        </div>

                        <div class="checkbox-group">
                            <input type="checkbox" id="multiclasse-toggle">
                            <label for="multiclasse-toggle">Personnage multiclass√©</label>
                        </div>

                        <div id="classe-simple" class="form-group">
                            <label for="classe">Classe :</label>
                            <select id="classe" required>
                                <option value="" disabled selected>S√©lectionnez une classe</option>
                                <option value="Artificier">Artificier</option>
                                <option value="Barbare">Barbare</option>
                                <option value="Barde">Barde</option>
                                <option value="Clerc">Clerc</option>
                                <option value="Druide">Druide</option>
                                <option value="Ensorceleur">Ensorceleur</option>
                                <option value="Guerrier">Guerrier</option>
                                <option value="Magicien">Magicien</option>
                                <option value="Moine">Moine</option>
                                <option value="Occultiste">Occultiste</option>
                                <option value="Paladin">Paladin</option>
                                <option value="R√¥deur">R√¥deur</option>
                                <option value="Roublard">Roublard</option>
                                <option value="Sorcier">Sorcier</option>
                            </select>
                        </div>

                        <div id="classe-multi" class="form-group hidden">
                            <label>Classes (ex: Magicien 13 / Artificier 1) :</label>
                            <input type="text" id="classe-complete" placeholder="Magicien 13 / Artificier 1">
                            <div class="help-text">Format : Classe1 Niveau / Classe2 Niveau / ...</div>
                        </div>

                        <!-- Onglets pour organiser les sections -->
                        <div class="tab-container mt-20">
                            <div class="tab-buttons">
                                <button class="tab-btn active" onclick="openTab('tab-quete')">üó°Ô∏è Qu√™te</button>
                                <button class="tab-btn" onclick="openTab('tab-xp')">‚≠ê XP & Niveau</button>
                                <button class="tab-btn" onclick="openTab('tab-pv')">‚ù§Ô∏è PV</button>
                                <button class="tab-btn" onclick="openTab('tab-capacites')">‚ú® Capacit√©s</button>
                                <button class="tab-btn" onclick="openTab('tab-items')">üéí Items</button>
                                <button class="tab-btn" onclick="openTab('tab-argent')">üí∞ Argent</button>
                                <button class="tab-btn" onclick="openTab('tab-artisanat')">üî® Artisanat</button>
                                <button class="tab-btn" onclick="openTab('tab-special')">‚ö° Sp√©cial</button>
                            </div>

                            <!-- Contenu des onglets -->
                            <div id="tab-quete" class="tab-content active">
                                <div class="form-group">
                                    <label for="section-quete">Description de la qu√™te :</label>
                                    <textarea id="section-quete" placeholder="D√©crivez ce qui s'est pass√© pendant la session..."></textarea>
                                </div>
                            </div>

                            <div id="tab-xp" class="tab-content">
                                <div class="two-columns">
                                    <div class="form-group">
                                        <label for="xp-actuels">XP actuels :</label>
                                        <input type="number" id="xp-actuels" min="0" placeholder="0">
                                    </div>
                                    <div class="form-group">
                                        <label for="total-xp-quetes">XP gagn√©s :</label>
                                        <input type="number" id="total-xp-quetes" min="0" placeholder="0">
                                    </div>
                                </div>
                                <div class="two-columns">
                                    <div class="form-group">
                                        <label for="niveau-actuel">Niveau actuel :</label>
                                        <input type="number" id="niveau-actuel" min="1" max="20" value="1">
                                    </div>
                                    <div class="form-group">
                                        <label for="niveau-cible">Niveau cible :</label>
                                        <input type="number" id="niveau-cible" min="1" max="20" value="1">
                                    </div>
                                </div>
                                <div class="form-group" id="classe-gain-niveau-group" style="display: none;">
                                    <label for="classe-gain-niveau">Classe qui gagne le niveau :</label>
                                    <select id="classe-gain-niveau">
                                        <option value="">S√©lectionnez une classe</option>
                                    </select>
                                </div>
                            </div>

                            <div id="tab-pv" class="tab-content">
                                <div class="two-columns">
                                    <div class="form-group">
                                        <label for="pv-actuels">PV actuels :</label>
                                        <input type="number" id="pv-actuels" min="0" placeholder="28">
                                    </div>
                                    <div class="form-group">
                                        <label for="mod-constitution">Mod. Constitution :</label>
                                        <input type="number" id="mod-constitution" min="-5" max="10" value="0">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="bonus-pv">Bonus PV (optionnel) :</label>
                                    <input type="text" id="bonus-pv" placeholder="Ex: Robuste, Nain des collines...">
                                    <div class="help-text">D√©crivez les sources de bonus aux PV</div>
                                </div>
                            </div>

                            <div id="tab-capacites" class="tab-content">
                                <div class="form-group">
                                    <label for="nouvelles-capacites">Nouvelles capacit√©s de classe :</label>
                                    <textarea id="nouvelles-capacites" placeholder="Ex: Attaque suppl√©mentaire, Vision dans le noir..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="nouveau-don">Nouveaux dons (ASI) :</label>
                                    <textarea id="nouveau-don" placeholder="Un don par ligne"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="don-quete">Dons de qu√™te :</label>
                                    <textarea id="don-quete" placeholder="Un don par ligne"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="nouveaux-sorts">Nouveaux sorts appris :</label>
                                    <textarea id="nouveaux-sorts" placeholder="Un sort par ligne"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="sorts-remplaces">Sorts remplac√©s :</label>
                                    <textarea id="sorts-remplaces" placeholder="Format: Ancien sort ‚Üí Nouveau sort"></textarea>
                                </div>
                            </div>

                            <div id="tab-items" class="tab-content">
                                <div class="form-group">
                                    <label for="objets-lootes">Objets loot√©s :</label>
                                    <textarea id="objets-lootes" placeholder="Un objet par ligne"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="objets-perdus">Objets perdus/utilis√©s :</label>
                                    <textarea id="objets-perdus" placeholder="Un objet par ligne"></textarea>
                                </div>
                            </div>

                            <div id="tab-argent" class="tab-content">
                                <div class="two-columns">
                                    <div class="form-group">
                                        <label for="po-lootees">PO loot√©es :</label>
                                        <input type="number" id="po-lootees" min="0" placeholder="0">
                                    </div>
                                    <div class="form-group">
                                        <label for="ancien-solde">Ancien solde (PO) :</label>
                                        <input type="number" id="ancien-solde" min="0" placeholder="0">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="po-recues">PO re√ßues (autres) :</label>
                                    <input type="number" id="po-recues" min="0" placeholder="0">
                                    <div class="help-text">R√©compenses, ventes, etc.</div>
                                </div>
                                
                                <h4 class="mt-20 mb-10">üí∏ Transactions</h4>
                                <div id="transactions-container">
                                    <div class="transaction-entry two-columns mb-10">
                                        <input type="text" class="transaction-desc" placeholder="Description (ex: Potion de soin)">
                                        <input type="number" class="transaction-cost" placeholder="Co√ªt en PO">
                                    </div>
                                </div>
                                <button type="button" class="btn-secondary mt-10" onclick="addTransaction()">+ Ajouter une transaction</button>
                            </div>

                            <div id="tab-artisanat" class="tab-content">
                                <div class="checkbox-group mb-15">
                                    <input type="checkbox" id="artisanat-active">
                                    <label for="artisanat-active">Inclure une section artisanat</label>
                                </div>
                                <div id="artisanat-fields" class="hidden">
                                    <div class="form-group">
                                        <label for="artisanat-nom">Nom de l'objet craft√© :</label>
                                        <input type="text" id="artisanat-nom" placeholder="Ex: Potion de soin sup√©rieure">
                                    </div>
                                    <div class="two-columns">
                                        <div class="form-group">
                                            <label for="artisanat-dc">DC du craft :</label>
                                            <input type="number" id="artisanat-dc" min="1" placeholder="15">
                                        </div>
                                        <div class="form-group">
                                            <label for="artisanat-resultat">R√©sultat du jet :</label>
                                            <input type="number" id="artisanat-resultat" min="1" placeholder="18">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="artisanat-cout">Co√ªt des mat√©riaux (PO) :</label>
                                        <input type="number" id="artisanat-cout" min="0" placeholder="25">
                                    </div>
                                </div>
                            </div>

                            <div id="tab-special" class="tab-content">
                                <div class="form-group">
                                    <label for="type-special">Type de section sp√©ciale :</label>
                                    <select id="type-special">
                                        <option value="">Aucune</option>
                                        <option value="marchand">MARCHAND</option>
                                        <option value="repos">REPOS LONG</option>
                                        <option value="downtime">DOWNTIME</option>
                                        <option value="autre">AUTRE</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="description-special">Description :</label>
                                    <textarea id="description-special" placeholder="D√©crivez l'activit√© sp√©ciale..."></textarea>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="section-marchand">
                                    <label for="section-marchand">Inclure une section marchand s√©par√©e</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Bouton de g√©n√©ration -->
                    <button class="btn-primary generate-btn" onclick="generateTemplate()" style="width: 100%; margin-top: 20px;">
                        üé≤ G√©n√©rer le Template
                    </button>
                </div>

                <!-- Colonne de droite : Sortie -->
                <div>
                    <div class="output-section">
                        <h3 style="color: white; margin-bottom: 15px;">üìù Template Discord</h3>
                        <div class="char-indicator" id="char-count-1">0 / 2000 caract√®res</div>
                        <div class="discord-output" id="output"></div>
                        <button class="copy-btn" id="copy-btn-part-1" onclick="copyPart(1)">üìã Copier</button>
                        
                        <div id="split-warning" class="warning-text mt-15 hidden">
                            ‚ö†Ô∏è Message trop long ! Divis√© en 2 parties.
                        </div>
                        
                        <div id="part-2-container" class="hidden mt-20">
                            <h4 style="color: white; margin-bottom: 10px;">üìù Partie 2</h4>
                            <div class="char-indicator" id="char-count-2">0 / 2000 caract√®res</div>
                            <div class="discord-output" id="output-part-2"></div>
                            <button class="copy-btn" id="copy-btn-part-2" onclick="copyPart(2)">üìã Copier Partie 2</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="maj-fiche-script.js"></script>
    <script>
        // Gestion des onglets
        function openTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-btn');
            
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Gestion du multiclassage
        document.getElementById('multiclasse-toggle').addEventListener('change', function() {
            const classeSimple = document.getElementById('classe-simple');
            const classeMulti = document.getElementById('classe-multi');
            const classeGainNiveauGroup = document.getElementById('classe-gain-niveau-group');
            
            if (this.checked) {
                classeSimple.classList.add('hidden');
                classeMulti.classList.remove('hidden');
                classeGainNiveauGroup.style.display = 'block';
            } else {
                classeSimple.classList.remove('hidden');
                classeMulti.classList.add('hidden');
                classeGainNiveauGroup.style.display = 'none';
            }
        });

        // Gestion de l'artisanat
        document.getElementById('artisanat-active').addEventListener('change', function() {
            const fields = document.getElementById('artisanat-fields');
            if (this.checked) {
                fields.classList.remove('hidden');
            } else {
                fields.classList.add('hidden');
            }
        });

        // Fonction pour ajouter une transaction
        function addTransaction() {
            const container = document.getElementById('transactions-container');
            const transactionHTML = `
                <div class="transaction-entry two-columns mb-10 fade-in">
                    <input type="text" class="transaction-desc" placeholder="Description">
                    <div class="flex gap-10">
                        <input type="number" class="transaction-cost" placeholder="Co√ªt en PO">
                        <button type="button" class="btn-danger" onclick="removeTransaction(this)" style="padding: 8px 12px;">‚úï</button>
                    </div>
                </div>
            `;
            container.insertAdjacentHTML('beforeend', transactionHTML);
        }

        // Fonction pour supprimer une transaction
        function removeTransaction(button) {
            const entry = button.closest('.transaction-entry');
            entry.style.animation = 'fadeOut 0.3s ease';
            setTimeout(() => entry.remove(), 300);
        }

        // Fonction pour copier
        function copyPart(partNumber) {
            const outputId = partNumber === 1 ? 'output' : 'output-part-2';
            const buttonId = partNumber === 1 ? 'copy-btn-part-1' : 'copy-btn-part-2';
            const output = document.getElementById(outputId);
            const button = document.getElementById(buttonId);
            
            if (output && output.textContent) {
                navigator.clipboard.writeText(output.textContent).then(() => {
                    button.classList.add('success');
                    button.textContent = '‚úÖ Copi√© !';
                    setTimeout(() => {
                        button.classList.remove('success');
                        button.textContent = `üìã Copier${partNumber === 2 ? ' Partie 2' : ''}`;
                    }, 2000);
                }).catch(err => {
                    console.error('Erreur lors de la copie :', err);
                    alert('Erreur lors de la copie. Veuillez s√©lectionner et copier manuellement.');
                });
            }
        }

        // Ajouter les animations CSS n√©cessaires
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeOut {
                from { opacity: 1; transform: scale(1); }
                to { opacity: 0; transform: scale(0.95); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>